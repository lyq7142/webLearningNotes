# 注册功能前端到数据库流程

* 常用登录方式：
Cookie + Session
Token
SSO单点登录
oAuth第三方登录

## cookie + session

用户第一次输入账户密码登录，服务器验证密码无误后，会创建sessionId，并保存起来（可能存放内存、文件、数据库...），服务器端响应这个HTTP请求，通过Set-Cookie头信息，将SessionId写入cookie中。
第一次登录完成后，后续的访问可以直接使用cookie进行身份验证。
用户访问页面时，会自动带上第一次登录时写入的cookie，服务器端比对cookie中的sessionId和保存在服务器端的是否一致。

问题：服务器存放大量sessionId，压力过大，需要同步到每台服务器，维护成本高，cookie无法避免CSRF攻击。

## token验证登录流程

1.客户端用用户名和密码请求登录
2.服务器收到请求，验证用户名和密码
3.验证成功，服务器签发一个token，发送给客户端
4.客户端收到token存储起来，放入cookie或localStorage
5.客户端每次向服务器请求资源 都要带着token
6.服务器收到请求，验证客户端携带的token，如果验证成功，就向客户端返回请求的数据

（客户端首次登录后，服务器再收到HTTP请求后，就只认token了，请求只要每次带上token就行，服务器会拦截所有请求，然后检验token，合法就放行，不合法就401 -> 鉴权失败）

简单的token组成：uid、time、sign
token常见生成方式：JWT

### JWT方案（JSON WEB TOKEN）

OAuth提出的通过对json进行加密签名来实现授权验证。通信双方之间以json对象的形式传递信息，即登录成功后将相关信息组成json对象，再进行加密，返回给客户端，客户端在下次请求时带上这个token，服务器再收到请求时校验token的合法性。

* JWT算法组成：
headers头信息：类别typ、加密算法alg
payload消息体：要传递的用户信息
signature签名：加密后的签名字串，只能在服务端解密

## SSO单点登录

在公司内部搭建一个公共的认证中心，公司下所有产品的登录都可以在认证中心里完成，一个产品在认证中心登录后，再去访问另一个产品，可以不用再次登录。

## oAuth第三方登录
